//
//  StandardVC.swift
//  WordsInTheDark
//
//  Created by Jason Lieu on 4/11/19.
//  Copyright Â© 2019 JasonApplication. All rights reserved.
//

import UIKit

class StandardVC : UIViewController {
    @IBOutlet var b00 : CustomButton!
    @IBOutlet var b01 : CustomButton!
    @IBOutlet var b02 : CustomButton!
    @IBOutlet var b03 : CustomButton!
    @IBOutlet var b04 : CustomButton!
    @IBOutlet var b05 : CustomButton!
    @IBOutlet var b06 : CustomButton!
    @IBOutlet var b07 : CustomButton!
    @IBOutlet var b08 : CustomButton!
    @IBOutlet var b09 : CustomButton!
    @IBOutlet var b0a : CustomButton!
    @IBOutlet var b0b : CustomButton!
    @IBOutlet var b0c : CustomButton!
    @IBOutlet var b0d : CustomButton!
    @IBOutlet var b0e : CustomButton!
    
    @IBOutlet var b10 : CustomButton!
    @IBOutlet var b11 : CustomButton!
    @IBOutlet var b12 : CustomButton!
    @IBOutlet var b13 : CustomButton!
    @IBOutlet var b14 : CustomButton!
    @IBOutlet var b15 : CustomButton!
    @IBOutlet var b16 : CustomButton!
    @IBOutlet var b17 : CustomButton!
    @IBOutlet var b18 : CustomButton!
    @IBOutlet var b19 : CustomButton!
    @IBOutlet var b1a : CustomButton!
    @IBOutlet var b1b : CustomButton!
    @IBOutlet var b1c : CustomButton!
    @IBOutlet var b1d : CustomButton!
    @IBOutlet var b1e : CustomButton!

    @IBOutlet var b20 : CustomButton!
    @IBOutlet var b21 : CustomButton!
    @IBOutlet var b22 : CustomButton!
    @IBOutlet var b23 : CustomButton!
    @IBOutlet var b24 : CustomButton!
    @IBOutlet var b25 : CustomButton!
    @IBOutlet var b26 : CustomButton!
    @IBOutlet var b27 : CustomButton!
    @IBOutlet var b28 : CustomButton!
    @IBOutlet var b29 : CustomButton!
    @IBOutlet var b2a : CustomButton!
    @IBOutlet var b2b : CustomButton!
    @IBOutlet var b2c : CustomButton!
    @IBOutlet var b2d : CustomButton!
    @IBOutlet var b2e : CustomButton!
    
    @IBOutlet var b30 : CustomButton!
    @IBOutlet var b31 : CustomButton!
    @IBOutlet var b32 : CustomButton!
    @IBOutlet var b33 : CustomButton!
    @IBOutlet var b34 : CustomButton!
    @IBOutlet var b35 : CustomButton!
    @IBOutlet var b36 : CustomButton!
    @IBOutlet var b37 : CustomButton!
    @IBOutlet var b38 : CustomButton!
    @IBOutlet var b39 : CustomButton!
    @IBOutlet var b3a : CustomButton!
    @IBOutlet var b3b : CustomButton!
    @IBOutlet var b3c : CustomButton!
    @IBOutlet var b3d : CustomButton!
    @IBOutlet var b3e : CustomButton!

    @IBOutlet var b40 : CustomButton!
    @IBOutlet var b41 : CustomButton!
    @IBOutlet var b42 : CustomButton!
    @IBOutlet var b43 : CustomButton!
    @IBOutlet var b44 : CustomButton!
    @IBOutlet var b45 : CustomButton!
    @IBOutlet var b46 : CustomButton!
    @IBOutlet var b47 : CustomButton!
    @IBOutlet var b48 : CustomButton!
    @IBOutlet var b49 : CustomButton!
    @IBOutlet var b4a : CustomButton!
    @IBOutlet var b4b : CustomButton!
    @IBOutlet var b4c : CustomButton!
    @IBOutlet var b4d : CustomButton!
    @IBOutlet var b4e : CustomButton!
    
    @IBOutlet var b50 : CustomButton!
    @IBOutlet var b51 : CustomButton!
    @IBOutlet var b52 : CustomButton!
    @IBOutlet var b53 : CustomButton!
    @IBOutlet var b54 : CustomButton!
    @IBOutlet var b55 : CustomButton!
    @IBOutlet var b56 : CustomButton!
    @IBOutlet var b57 : CustomButton!
    @IBOutlet var b58 : CustomButton!
    @IBOutlet var b59 : CustomButton!
    @IBOutlet var b5a : CustomButton!
    @IBOutlet var b5b : CustomButton!
    @IBOutlet var b5c : CustomButton!
    @IBOutlet var b5d : CustomButton!
    @IBOutlet var b5e : CustomButton!
    
    @IBOutlet var b60 : CustomButton!
    @IBOutlet var b61 : CustomButton!
    @IBOutlet var b62 : CustomButton!
    @IBOutlet var b63 : CustomButton!
    @IBOutlet var b64 : CustomButton!
    @IBOutlet var b65 : CustomButton!
    @IBOutlet var b66 : CustomButton!
    @IBOutlet var b67 : CustomButton!
    @IBOutlet var b68 : CustomButton!
    @IBOutlet var b69 : CustomButton!
    @IBOutlet var b6a : CustomButton!
    @IBOutlet var b6b : CustomButton!
    @IBOutlet var b6c : CustomButton!
    @IBOutlet var b6d : CustomButton!
    @IBOutlet var b6e : CustomButton!
    
    @IBOutlet var b70 : CustomButton!
    @IBOutlet var b71 : CustomButton!
    @IBOutlet var b72 : CustomButton!
    @IBOutlet var b73 : CustomButton!
    @IBOutlet var b74 : CustomButton!
    @IBOutlet var b75 : CustomButton!
    @IBOutlet var b76 : CustomButton!
    @IBOutlet var b77 : CustomButton!
    @IBOutlet var b78 : CustomButton!
    @IBOutlet var b79 : CustomButton!
    @IBOutlet var b7a : CustomButton!
    @IBOutlet var b7b : CustomButton!
    @IBOutlet var b7c : CustomButton!
    @IBOutlet var b7d : CustomButton!
    @IBOutlet var b7e : CustomButton!

    @IBOutlet var b80 : CustomButton!
    @IBOutlet var b81 : CustomButton!
    @IBOutlet var b82 : CustomButton!
    @IBOutlet var b83 : CustomButton!
    @IBOutlet var b84 : CustomButton!
    @IBOutlet var b85 : CustomButton!
    @IBOutlet var b86 : CustomButton!
    @IBOutlet var b87 : CustomButton!
    @IBOutlet var b88 : CustomButton!
    @IBOutlet var b89 : CustomButton!
    @IBOutlet var b8a : CustomButton!
    @IBOutlet var b8b : CustomButton!
    @IBOutlet var b8c : CustomButton!
    @IBOutlet var b8d : CustomButton!
    @IBOutlet var b8e : CustomButton!
    
    @IBOutlet var b90 : CustomButton!
    @IBOutlet var b91 : CustomButton!
    @IBOutlet var b92 : CustomButton!
    @IBOutlet var b93 : CustomButton!
    @IBOutlet var b94 : CustomButton!
    @IBOutlet var b95 : CustomButton!
    @IBOutlet var b96 : CustomButton!
    @IBOutlet var b97 : CustomButton!
    @IBOutlet var b98 : CustomButton!
    @IBOutlet var b99 : CustomButton!
    @IBOutlet var b9a : CustomButton!
    @IBOutlet var b9b : CustomButton!
    @IBOutlet var b9c : CustomButton!
    @IBOutlet var b9d : CustomButton!
    @IBOutlet var b9e : CustomButton!
    
    @IBOutlet var ba0 : CustomButton!
    @IBOutlet var ba1 : CustomButton!
    @IBOutlet var ba2 : CustomButton!
    @IBOutlet var ba3 : CustomButton!
    @IBOutlet var ba4 : CustomButton!
    @IBOutlet var ba5 : CustomButton!
    @IBOutlet var ba6 : CustomButton!
    @IBOutlet var ba7 : CustomButton!
    @IBOutlet var ba8 : CustomButton!
    @IBOutlet var ba9 : CustomButton!
    @IBOutlet var baa : CustomButton!
    @IBOutlet var bab : CustomButton!
    @IBOutlet var bac : CustomButton!
    @IBOutlet var bad : CustomButton!
    @IBOutlet var bae : CustomButton!
    
    @IBOutlet var bb0 : CustomButton!
    @IBOutlet var bb1 : CustomButton!
    @IBOutlet var bb2 : CustomButton!
    @IBOutlet var bb3 : CustomButton!
    @IBOutlet var bb4 : CustomButton!
    @IBOutlet var bb5 : CustomButton!
    @IBOutlet var bb6 : CustomButton!
    @IBOutlet var bb7 : CustomButton!
    @IBOutlet var bb8 : CustomButton!
    @IBOutlet var bb9 : CustomButton!
    @IBOutlet var bba : CustomButton!
    @IBOutlet var bbb : CustomButton!
    @IBOutlet var bbc : CustomButton!
    @IBOutlet var bbd : CustomButton!
    @IBOutlet var bbe : CustomButton!
    
    @IBOutlet var bc0 : CustomButton!
    @IBOutlet var bc1 : CustomButton!
    @IBOutlet var bc2 : CustomButton!
    @IBOutlet var bc3 : CustomButton!
    @IBOutlet var bc4 : CustomButton!
    @IBOutlet var bc5 : CustomButton!
    @IBOutlet var bc6 : CustomButton!
    @IBOutlet var bc7 : CustomButton!
    @IBOutlet var bc8 : CustomButton!
    @IBOutlet var bc9 : CustomButton!
    @IBOutlet var bca : CustomButton!
    @IBOutlet var bcb : CustomButton!
    @IBOutlet var bcc : CustomButton!
    @IBOutlet var bcd : CustomButton!
    @IBOutlet var bce : CustomButton!

    @IBOutlet var bd0 : CustomButton!
    @IBOutlet var bd1 : CustomButton!
    @IBOutlet var bd2 : CustomButton!
    @IBOutlet var bd3 : CustomButton!
    @IBOutlet var bd4 : CustomButton!
    @IBOutlet var bd5 : CustomButton!
    @IBOutlet var bd6 : CustomButton!
    @IBOutlet var bd7 : CustomButton!
    @IBOutlet var bd8 : CustomButton!
    @IBOutlet var bd9 : CustomButton!
    @IBOutlet var bda : CustomButton!
    @IBOutlet var bdb : CustomButton!
    @IBOutlet var bdc : CustomButton!
    @IBOutlet var bdd : CustomButton!
    @IBOutlet var bde : CustomButton!
    
    @IBOutlet var be0 : CustomButton!
    @IBOutlet var be1 : CustomButton!
    @IBOutlet var be2 : CustomButton!
    @IBOutlet var be3 : CustomButton!
    @IBOutlet var be4 : CustomButton!
    @IBOutlet var be5 : CustomButton!
    @IBOutlet var be6 : CustomButton!
    @IBOutlet var be7 : CustomButton!
    @IBOutlet var be8 : CustomButton!
    @IBOutlet var be9 : CustomButton!
    @IBOutlet var bea : CustomButton!
    @IBOutlet var beb : CustomButton!
    @IBOutlet var bec : CustomButton!
    @IBOutlet var bed : CustomButton!
    @IBOutlet var bee : CustomButton!
    
    @IBOutlet var resetButton : UIButton!
    @IBOutlet var resetYES : UIButton!
    @IBOutlet var resetNO : UIButton!
    @IBOutlet var hintLabel : UILabel!
    @IBOutlet var endLabel : UILabel!
    @IBOutlet var againButton : UIButton!
    @IBOutlet var notAgainButton : UIButton!
    @IBOutlet var backButton : UIButton!
    @IBOutlet var backdropLabel : UILabel!
    let invisTextField = UITextField(frame: CGRect.zero)
    var buttons : [[CustomButton]]!
    let generator : StandardGenerator = StandardGenerator()
    var currentButtonX : Int = 0
    var currentButtonY : Int = 0
    var grid : [[Character]] = [
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "]
    ]
    var answerGrid : [[Character]] = [
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "]
    ]
    let endPhrases : [String] = ["That was short. Again?", "Want to go again?"]
    var currentWordLength : Int = 0
    var currentLetterCount : Int = 0
    var currentX : Int = 0
    var currentY : Int = 0
    var currentWord : (String, String) = (" "," ")
    var currentOrientation : Bool = true
    var intersectionCounted : Bool = false
    var intersectIndex : (Int, Int)? = nil
    var buttonHistory : [(Int, Int)] = []
    var gameOver : Bool = false
    var wordCount : Int = 0
    func startGame(){
        let first = generator.startGame()
        for y in 0 ... 14 {
            for x in 0 ... 14 {
                answerGrid[y][x] = generator.grid[y][x].letter
                if generator.grid[y][x].letter != "-" && generator.grid[y][x].letter != " "{
                    buttons[y][x].backgroundColor = UIColor.white
                    buttons[y][x].isEnabled = true
                }
            }
        }
        currentWord = first.0
        currentWordLength = currentWord.0.count
        currentX = first.1
        currentY = first.2
        currentButtonY = currentY
        currentButtonX = currentX
        hintLabel.text = currentWord.1
        wordCount = 1
        print(currentWord)
    }
    @IBAction func buttonPressed(_ sender: CustomButton) {
        currentButtonX = sender.X
        currentButtonY = sender.Y
        sender.borderWidth = 2
        sender.borderColor = UIColor(displayP3Red: 1, green: 203/255, blue: 5/255, alpha: 1)
        invisTextField.becomeFirstResponder()
    }
    @IBAction func textFieldEditingDidChange( sender: UITextField){
        buttons[currentButtonY][currentButtonX].setTitle((invisTextField.text)?.uppercased(), for: .normal)
        buttons[currentButtonY][currentButtonX].borderWidth = 1
        buttons[currentButtonY][currentButtonX].borderColor = UIColor(displayP3Red: 49/255, green: 51/255, blue: 53/255, alpha: 1)
        /*if buttons[currentButtonY][currentButtonX].titleLabel?.text == " " {
            currentLetterCount += 1
        }
        else if intersectIndex != nil {
            if currentOrientation {
                if intersectIndex!.0 == currentButtonX && !intersectionCounted { //y is needed
                    intersectionCounted = true
                    currentLetterCount += 1
                }
            }
            else if !currentOrientation {
                if intersectIndex!.1 == currentButtonY && !intersectionCounted {
                    intersectionCounted = true
                    currentLetterCount += 1
                }
            }
        }*/
        //if another letter is intersecting, wont count
        //array of counted X or Y, depending on orientation*
        if currentOrientation {
            if currentY == currentButtonY { //correct Y
                if currentX <= currentButtonX  && currentButtonX <= currentX + currentWordLength - 1 { //X in range
                    if !buttonHistory.contains(where: {$0.0 == currentButtonX && $0.1 == currentButtonY }){ // not in history, add +1
                        buttonHistory.append((currentButtonX, currentButtonY))
                        currentLetterCount += 1
                    }
                }
            }
        }
        else {
            if currentX == currentButtonX {
                if currentY <= currentButtonY && currentButtonY <= currentY + currentWordLength - 1 {
                    if !buttonHistory.contains(where: {$0.0 == currentButtonX && $0.1 == currentButtonY }){
                        buttonHistory.append((currentButtonX, currentButtonY))
                        currentLetterCount += 1
                    }
                }
            }
        }
        grid[currentButtonY][currentButtonX] = Character(invisTextField.text!.uppercased())
        invisTextField.text = nil
        if currentLetterCount < currentWordLength {
            var canMoveToNext = true
            if currentOrientation && currentButtonX < 14{
                currentButtonX += 1
                if currentButtonX >= currentX + currentWordLength {
                    canMoveToNext = false
                }
            }
            else if currentButtonY < 14{
                currentButtonY += 1
                if currentButtonY >= currentY + currentWordLength {
                    canMoveToNext = false
                }
            }
            if canMoveToNext {
                buttonPressed(buttons[currentButtonY][currentButtonX])
            }
        }
        else{
            invisTextField.resignFirstResponder()
            checkWord()
        }
    }
    func checkWord(){
        var correct : Bool = true
        for y in 0...14{
            for x in 0...14{
                if answerGrid[y][x] == "-" || answerGrid[y][x] == " "{
                    continue
                }
                if answerGrid[y][x] != grid[y][x] {
                    correct = false
                    buttons[y][x].borderColor = UIColor.red
                }
                else {
                    buttons[y][x].borderColor = UIColor(displayP3Red: 49/255, green: 51/255, blue: 53/255, alpha: 1)
                }
            }
        }
        if correct {
            nextBoard()
            currentButtonX = currentX
            currentButtonY = currentY
            for y in 0 ... 14 {
                for x in 0 ... 14 {
                    answerGrid[y][x] = generator.grid[y][x].letter
                    //buttons[y][x].setTitle(String(grid[y][x]), for: .normal) //TESTING ONLY
                    if generator.grid[y][x].letter != "-" && generator.grid[y][x].letter != " "{
                        buttons[y][x].backgroundColor = UIColor.white
                        buttons[y][x].isEnabled = true
                    }
                }
            }
            if !gameOver { buttonPressed(buttons[currentButtonY][currentButtonX]) }
        }
    }
    func nextBoard(){
        let next = generator.nextBoard()
        if next != nil {
            intersectIndex = next?.3
            currentX = next!.1
            currentY = next!.2
            currentWord = next!.0
            currentOrientation = next!.4
            currentWordLength = currentWord.0.count
            currentLetterCount = 0
            intersectionCounted = false
            hintLabel.text = currentWord.1
            buttonHistory = []
            wordCount += 1
            for y in 0 ... 14 {
                for x in 0 ... 14 {
                    answerGrid[y][x] = generator.grid[y][x].letter
                }
            }
        }
        else {
            gameOver = true
            invisTextField.resignFirstResponder()
            if wordCount < 7 {
                endLabel.text = endPhrases[0]
            }
            else {
                endLabel.text = endPhrases[1]
            }
            againButton.isEnabled = true
            notAgainButton.isEnabled = true
            resetButton.isEnabled = false
            UIView.animate(withDuration: 0.5, delay: 0.8, options: .curveEaseOut, animations: {
                self.endLabel.alpha = 1
                self.againButton.alpha = 1
                self.notAgainButton.alpha = 1
                self.hintLabel.alpha = 0
                self.resetButton.alpha = 0
            })
        }
    }
    @IBAction func resetButton(_ sender: UIButton){
        hintLabel.text = "Are you sure you want to reset?"
        resetButton.isEnabled = false
        resetYES.isEnabled = true
        resetNO.isEnabled = true
        UIView.animate(withDuration: 0.5, delay: 0, options: .curveEaseOut, animations: {
            self.resetButton.alpha = 0
        }, completion: {
            _ in
            UIView.animate(withDuration: 0.5, delay: 0, options: .curveEaseOut, animations: {
                self.resetYES.alpha = 1
                self.resetNO.alpha = 1
            })
        })
    }
    @IBAction func resetYES(_ sender: UIButton){
        resetGame()
        resetYES.isEnabled = false
        resetNO.isEnabled = false
        resetButton.isEnabled = true
        UIView.animate(withDuration: 0.5, delay: 0, options: .curveEaseOut, animations: {
            self.resetYES.alpha = 0
            self.resetNO.alpha = 0
        }, completion: {
            _ in
            UIView.animate(withDuration: 0.5, delay: 0, options: .curveEaseOut, animations: {
                self.resetButton.alpha = 1
            })
        })
    }
    @IBAction func resetNO(_ sender:UIButton){
        hintLabel.text = currentWord.1
        resetYES.isEnabled = false
        resetNO.isEnabled = false
        resetButton.isEnabled = true
        UIView.animate(withDuration: 0.5, delay: 0, options: .curveEaseOut, animations: {
            self.resetYES.alpha = 0
            self.resetNO.alpha = 0
        }, completion: {
            _ in
            UIView.animate(withDuration: 0.5, delay: 0, options: .curveEaseOut, animations: {
                self.resetButton.alpha = 1
            })
        })
    }
    func resetGame(){
        grid = [
            [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
            [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
            [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
            [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
            [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
            [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
            [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
            [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
            [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
            [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
            [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
            [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
            [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
            [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
            [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "]
        ]
        answerGrid = grid
        currentButtonX = 0
        currentButtonY = 0
        currentWordLength = 0
        currentLetterCount = 0
        currentX = 0
        currentY = 0
        currentWord = (" "," ")
        currentOrientation = true
        intersectionCounted = false
        intersectIndex = nil
        buttonHistory = []
        gameOver = false
        wordCount = 0
        for y in 0 ... 14 {
            for x in 0 ... 14 {
                buttons[y][x].setTitle(" ", for: .normal)
                buttons[y][x].backgroundColor = UIColor(displayP3Red: 49/255, green: 51/255, blue: 53/255, alpha: 1)
                buttons[y][x].borderColor = UIColor(displayP3Red: 49/255, green: 51/255, blue: 53/255, alpha: 1)
                buttons[y][x].borderWidth = 1
                buttons[y][x].X = x
                buttons[y][x].Y = y
                buttons[y][x].isEnabled = false
            }
        }
        generator.reset()
        startGame()
        buttonPressed(buttons[currentButtonY][currentButtonX])
    }
    @IBAction func againButton(_ sender: UIButton){
        resetGame()
        endLabel.alpha = 0
        againButton.alpha = 0
        notAgainButton.alpha = 0
        againButton.isEnabled = false
        notAgainButton.isEnabled = false
        resetButton.isEnabled = true
        UIView.animate(withDuration: 0.5, delay: 0, options: .curveEaseOut, animations: {
            self.hintLabel.alpha = 1
            self.resetButton.alpha = 1
        })
    }
    @IBAction func notAgainButton(_ sender: UIButton){
        invisTextField.resignFirstResponder()
        UIView.animate(withDuration: 1.5, animations: {
            self.view.alpha = 0
        }, completion: {
            _ in
            self.performSegue(withIdentifier: "toMenu", sender: self)
        })
    }
    override func viewDidLoad() {
        super.viewDidLoad()
        self.view.addSubview(invisTextField)
        invisTextField.addTarget(self, action: #selector(textFieldEditingDidChange), for: UIControl.Event.editingChanged)
        buttons = [
            [ b00, b01, b02, b03, b04, b05, b06, b07, b08, b09, b0a, b0b, b0c, b0d, b0e],
            [ b10, b11, b12, b13, b14, b15, b16, b17, b18, b19, b1a, b1b, b1c, b1d, b1e],
            [ b20, b21, b22, b23, b24, b25, b26, b27, b28, b29, b2a, b2b, b2c, b2d, b2e],
            [ b30, b31, b32, b33, b34, b35, b36, b37, b38, b39, b3a, b3b, b3c, b3d, b3e],
            [ b40, b41, b42, b43, b44, b45, b46, b47, b48, b49, b4a, b4b, b4c, b4d, b4e],
            [ b50, b51, b52, b53, b54, b55, b56, b57, b58, b59, b5a, b5b, b5c, b5d, b5e],
            [ b60, b61, b62, b63, b64, b65, b66, b67, b68, b69, b6a, b6b, b6c, b6d, b6e],
            [ b70, b71, b72, b73, b74, b75, b76, b77, b78, b79, b7a, b7b, b7c, b7d, b7e],
            [ b80, b81, b82, b83, b84, b85, b86, b87, b88, b89, b8a, b8b, b8c, b8d, b8e],
            [ b90, b91, b92, b93, b94, b95, b96, b97, b98, b99, b9a, b9b, b9c, b9d, b9e],
            [ ba0, ba1, ba2, ba3, ba4, ba5, ba6, ba7, ba8, ba9, baa, bab, bac, bad, bae],
            [ bb0, bb1, bb2, bb3, bb4, bb5, bb6, bb7, bb8, bb9, bba, bbb, bbc, bbd, bbe],
            [ bc0, bc1, bc2, bc3, bc4, bc5, bc6, bc7, bc8, bc9, bca, bcb, bcc, bcd, bce],
            [ bd0, bd1, bd2, bd3, bd4, bd5, bd6, bd7, bd8, bd9, bda, bdb, bdc, bdd, bde],
            [ be0, be1, be2, be3, be4, be5, be6, be7, be8, be9, bea, beb, bec, bed, bee]

        ]
        view.backgroundColor = UIColor(displayP3Red: 49/255, green: 51/255, blue: 53/255, alpha: 1)
        hintLabel.textColor = UIColor.white
        for y in 0 ... 14 {
            for x in 0 ... 14 {
                buttons[y][x].setTitle(" ", for: .normal)
                //buttons[y][x].backgroundColor = UIColor(displayP3Red: 69/255, green: 72/255, blue: 72/255, alpha: 1)
                buttons[y][x].backgroundColor = UIColor(displayP3Red: 49/255, green: 51/255, blue: 53/255, alpha: 1)
                buttons[y][x].borderColor = UIColor(displayP3Red: 49/255, green: 51/255, blue: 53/255, alpha: 1)
                buttons[y][x].borderWidth = 1
                buttons[y][x].X = x
                buttons[y][x].Y = y
                buttons[y][x].isEnabled = false
            }
        }
        startGame()
        //DispatchQueue.main.asyncAfter(deadline: .now() + 3, execute: {
        //    self.buttonPressed(self.buttons[self.currentButtonY][self.currentButtonX])
        //})
        endLabel.alpha = 0
        endLabel.textColor = UIColor.white
        resetButton.setTitle("reset", for: .normal)
        resetButton.setTitleColor(UIColor(displayP3Red: 1, green: 203/255, blue: 5/255, alpha: 1), for: .normal)
        resetYES.setTitle("yes", for: .normal)
        resetYES.setTitleColor(UIColor(displayP3Red: 1, green: 203/255, blue: 5/255, alpha: 1), for: .normal)
        resetNO.setTitle("no", for: .normal)
        resetNO.setTitleColor(UIColor(displayP3Red: 1, green: 203/255, blue: 5/255, alpha: 1), for: .normal)
        resetYES.alpha = 0
        resetNO.alpha = 0
        resetYES.isEnabled = false
        resetNO.isEnabled = false
        againButton.isEnabled = false
        againButton.setTitle("yes", for: .normal)
        againButton.setTitleColor(UIColor(displayP3Red: 1, green: 203/255, blue: 5/255, alpha: 1), for: .normal)
        againButton.alpha = 0
        notAgainButton.isEnabled = false
        notAgainButton.setTitle("no", for: .normal)
        notAgainButton.setTitleColor(UIColor(displayP3Red: 1, green: 203/255, blue: 5/255, alpha: 1), for: .normal)
        notAgainButton.alpha = 0
        backButton.setTitle("back", for: .normal)
        backButton.setTitleColor(UIColor(displayP3Red: 1, green: 203/255, blue: 5/255, alpha: 1), for: .normal)
        backdropLabel.text = ""
        backdropLabel.backgroundColor = UIColor(displayP3Red: 50/255, green: 62/255, blue: 64/255, alpha: 1)
        self.view.alpha = 0
    }
    override func viewDidAppear(_ animated: Bool) {
        super.viewDidAppear(true)
        UIView.animate(withDuration: 1.5, animations: {
            self.view.alpha = 1
        }, completion: {
            _ in
            self.buttonPressed(self.buttons[self.currentButtonY][self.currentButtonX])
        })
    }
}
